angular.module("board",["resource.messages"]).config(["$routeProvider",function(n){return n.when("/board",{templateUrl:"/Content/app/board/board.tpl.html",controller:"BoardCtrl",title:"Message Boards",resolve:{messages:["$q","Message",function(n,t){var i;return i=n.defer(),t.queryOnce({$filter:"IsDeleted eq false"},function(n){var t,r,f,u;for(u=n.value,r=0,f=u.length;r<f;r++)t=u[r],t.Avatar||(t.Avatar=t.Email?"http://www.gravatar.com/avatar/"+md5(t.Email):"/Content/img/avatar.png");return i.resolve(n.value)}),i.promise}]}})}]).controller("BoardCtrl",["$scope","$translate","progressbar","Message","messages","account",function(n,t,i,r,u,f){return f.get().then(function(t){return n.entity={Author:t.UserName,Email:t.Email,Url:t.Url},n.editmode=!t.UserName}),n.list=u,n.save=function(){if(n.submitted=!0,!n.form.$invalid)return i.start(),n.loading=t("global.post"),n.entity.BoardId=UUID.generate(),r.save(n.entity,function(t){return n.list.unshift(t),n.entity.Content="",i.complete(),n.submitted=!1,n.loading=""},function(){return n.submitted=!1,n.loading=""})},n.remove=function(n){return message.confirm(function(){return r.remove({id:"(guid'"+n.BoardId+"')"},function(){return n.IsDeleted=!0,message.success("Message has been removed.")})})}}])